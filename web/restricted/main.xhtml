<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/WEB-INF/pageTemplate.xhtml"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    
    <ui:define name="title">TIMS</ui:define>
    <ui:param name="link" value="Home"/>
    <ui:define name="content">
    <h:form>
    <p:accordionPanel>
        <p:tab id="array" title="Array Data" titleStyleClass="tab-title">
            <h:panelGrid cellpadding="1">
                <p:commandLink action="#{menuSelBean.setupPlConfigPageURL}" 
                               value="#{msg['cnv-affymetrix']}" update=":dlgForm" 
                               styleClass="mainmenuitem" oncomplete="PF('dlg').show()">
                    <f:setPropertyActionListener target="#{menuSelBean.plName}" 
                                                 value="cnv-affymetrix"/>
                </p:commandLink>
                <p:commandLink action="#{menuSelBean.setupPlConfigPageURL}" 
                               value="#{msg['cnv-illumina']}" update=":dlgForm" 
                               styleClass="mainmenuitem" oncomplete="PF('dlg').show()">
                    <f:setPropertyActionListener target="#{menuSelBean.plName}" 
                                                 value="cnv-illumina"/>
                </p:commandLink>
                <p:commandLink action="#{menuSelBean.setupPlConfigPageURL}" 
                               value="#{msg['gex-affymetrix']}" update=":dlgForm" 
                               styleClass="mainmenuitem" oncomplete="PF('dlg').show()">
                    <f:setPropertyActionListener target="#{menuSelBean.plName}" 
                                                 value="gex-affymetrix"/>
                </p:commandLink>
                <p:commandLink action="#{menuSelBean.setupPlConfigPageURL}"
                               value="#{msg['gex-illumina']}" update=":dlgForm" 
                               styleClass="mainmenuitem" oncomplete="PF('dlg').show()">
                    <f:setPropertyActionListener target="#{menuSelBean.plName}" 
                                                 value="gex-illumina"/>
                </p:commandLink>
                <p:commandLink action="#{menuSelBean.setupPlConfigPageURL}" 
                               value="#{msg['meth-pipeline']}" update=":dlgForm" 
                               styleClass="mainmenuitem" oncomplete="PF('dlg').show()">
                    <f:setPropertyActionListener target="#{menuSelBean.plName}" 
                                                 value="meth-pipeline"/>
                </p:commandLink>
            </h:panelGrid>
        </p:tab>
            
        <p:tab id="ngs" title="NGS Data" titleStyleClass="tab-title">
            <h:panelGrid>
                <p:commandLink action="#{menuSelBean.setupPlConfigPageURL}"
                               value="#{msg['gatk-wg-germ']}" update=":dlgForm"
                               styleClass="mainmenuitem" oncomplete="PF('dlg').show()">
                    <f:setPropertyActionListener target="#{menuSelBean.plName}" 
                                                 value="gatk-wg-germ"/>
                </p:commandLink>
                <p:commandLink action="#{menuSelBean.setupPlConfigPageURL}"
                               value="#{msg['gatk-wg-soma']}"  update=":dlgForm"
                               styleClass="mainmenuitem" oncomplete="PF('dlg').show()">
                    <f:setPropertyActionListener target="#{menuSelBean.plName}" 
                                                 value="gatk-wg-soma"/>
                </p:commandLink>
                <p:commandLink action="#{menuSelBean.setupPlConfigPageURL}"
                               value="#{msg['gatk-tar-germ']}" update=":dlgForm"
                               styleClass="mainmenuitem" oncomplete="PF('dlg').show()">
                    <f:setPropertyActionListener target="#{menuSelBean.plName}" 
                                                 value="gatk-tar-germ"/>
                </p:commandLink>
                <p:commandLink action="#{menuSelBean.setupPlConfigPageURL}"
                               value="#{msg['gatk-tar-soma']}"  update=":dlgForm"
                               styleClass="mainmenuitem" oncomplete="PF('dlg').show()">
                    <f:setPropertyActionListener target="#{menuSelBean.plName}" 
                                                 value="gatk-tar-soma"/>
                </p:commandLink>
                <p:commandLink action="#{menuSelBean.setupPlConfigPageURL}" 
                               value="#{msg['seq-rna']}" update=":dlgForm" 
                               styleClass="mainmenuitem" oncomplete="PF('dlg').show()">
                    <f:setPropertyActionListener target="#{menuSelBean.plName}" 
                                                 value="seq-rna"/>
                </p:commandLink>
            </h:panelGrid>
        </p:tab>

        <p:tab id="visualization" rendered="#{authBean.visualizationON}" 
               title="Visualization" titleStyleClass="tab-title">
            <h:panelGrid cellpadding="1">
                <h:outputLink title="Select the job(s) to export for visualization" 
                              onclick="PF('visDlg').show(); return false;"
                              styleClass="mainmenuitem">
                    Setup Study for Visualization
                </h:outputLink>
                <h:outputLink title="Visualize my study data" 
                              value="visualizemystudy.xhtml" styleClass="mainmenuitem">
                    Visualize my Study Data
                </h:outputLink>
            </h:panelGrid>
        </p:tab>
            
        <p:tab id="clData" title="Subject Data" titleStyleClass="tab-title">
            <h:panelGrid cellpadding="1">
                <p:commandLink value="#{msg['md-mgnt']}" 
                               action="#{menuSelBean.setupStudyList}"
                               styleClass="mainmenuitem" update=":mdDlgForm"
                               title="Upload or edit subject meta data"
                               oncomplete="PF('mdDlg').show()"/>
                <p:commandLink value="#{msg['rd-mgnt']}" 
                               action="#{menuSelBean.setupRawDataMgnt}"
                               styleClass="mainmenuitem" update=":rdDlgForm"
                               title="Manage subject raw data"
                               oncomplete="PF('rdDlg').show()"/>
            </h:panelGrid>
        </p:tab>

        <p:tab id="job" title="My Work Area" titleStyleClass="tab-title">
            <h:panelGrid cellpadding="1">
                <h:commandLink title="View my job submission status" 
                               value="#{msg['job-status']}" 
                               action="#{authBean.singleUserJobStatus}" 
                               styleClass="mainmenuitem"/>
                <h:outputLink title="Review my studies" value="studiesreview.xhtml" 
                              styleClass="mainmenuitem">
                    Studies Review
                </h:outputLink>
                <h:outputLink title="Download consolidated output and summary report" 
                              value="completedstudyoutput.xhtml" 
                              styleClass="mainmenuitem">
                    Completed Study Output
                </h:outputLink>
            </h:panelGrid>
        </p:tab>
        
        <p:tab id="study" rendered="#{authBean.adminPILead}" title="My Study" titleStyleClass="tab-title">
            <h:panelGrid cellpadding="1">
                <h:outputLink title="#{msg['finalize-study']}" value="finalizestudy.xhtml" 
                              styleClass="mainmenuitem" rendered="#{authBean.PILead}">
                    Finalize Study
                </h:outputLink>
                <h:outputLink title="#{msg['unfinalize-study']}" value="unfinalizestudy.xhtml" 
                              styleClass="mainmenuitem" rendered="#{authBean.administrator}">
                    Unfinalize Study
                </h:outputLink>
                <h:outputLink title="#{msg['close-study']}" value="closestudy.xhtml" 
                              styleClass="mainmenuitem" rendered="#{authBean.administrator}">
                    Close Study
                </h:outputLink>
            </h:panelGrid>
        </p:tab>
    </p:accordionPanel>
    </h:form>

    <p:dialog modal="true" header="Select Study and Pipeline to work on" 
              widgetVar="rdDlg" resizable="false">
        <h:form id="rdDlgForm">
            <h:panelGrid columns="2">
                <p:outputLabel value="Study: " styleClass="configlabel"/>
                <p:selectOneMenu id="rdDlg-studyID" value="#{menuSelBean.study_id}">
                    <f:selectItem itemLabel="Select Study" itemValue=""/>
                    <f:selectItems value="#{menuSelBean.studyList}"/>
                    <p:ajax update="rdDlg-selPanel"/>
                </p:selectOneMenu>

                <p:outputLabel value="Pipeline: " styleClass="configlabel"/>
                <p:selectOneMenu id="rdDlg-pipeline" value="#{menuSelBean.plName}">
                    <f:selectItems value="#{menuSelBean.pipelineList}"/>
                </p:selectOneMenu>
            </h:panelGrid>
            <p:separator styleClass="configsep"/>
            
            <h:panelGrid id="rdDlg-selPanel" width="100%" columns="2" cellspacing="2" 
                         cellpadding="2">
                <p:commandButton value="Cancel" oncomplete="PF('rdDlg').hide()" 
                                 action="#{menuSelBean.backToMainMenu}" 
                                 style="width: 100%"/>
                <p:commandButton value="Proceed" 
                                 rendered="#{menuSelBean.studySelectedStatus}" 
                                 action="#{menuSelBean.proceedToRawDataMgnt}" 
                                 style="width: 100%"/>
            </h:panelGrid>
        </h:form>
    </p:dialog>

    <p:dialog modal="true" header="Select visualiser to work with" 
              widgetVar="visDlg" resizable="false">
        <h:form id="visDlgForm">
            <h:panelGrid columns="1">
                <h:panelGroup>
                    <p:selectOneMenu id="visDlg-visualiser" 
                                     value="#{menuSelBean.visualiser}">
                        <f:selectItem itemLabel="Select Visualiser" itemValue=""/>
                        <f:selectItem itemLabel="cBioPortal" itemValue="CBIO"/>
                        <p:ajax update="visDlg-selPanel"/>
                    </p:selectOneMenu>
                </h:panelGroup>
            </h:panelGrid>
            <p:separator styleClass="configsep"/>
            
            <h:panelGrid id="visDlg-selPanel" width="100%" columns="2" 
                         cellspacing="2" cellpadding="2">
                <p:commandButton value="Cancel" oncomplete="PF('visDlg').hide()" 
                                 action="#{menuSelBean.backToMainMenu}" 
                                 style="width: 100%"/>
                <p:commandButton value="Proceed" 
                                 rendered="#{menuSelBean.visualiserSelectedStatus}" 
                                 action="#{menuSelBean.proceedToJobSelection4v}" 
                                 style="width: 100%"/>
            </h:panelGrid>
        </h:form>
    </p:dialog>

    <p:dialog modal="true" header="Select Study to work on" 
              widgetVar="mdDlg" resizable="false">
        <h:form id="mdDlgForm">
            <h:panelGrid columns="1">
                <h:panelGroup>
                    <p:selectOneMenu id="mdDlg-studyID" value="#{menuSelBean.study_id}">
                        <f:selectItem itemLabel="Select Study" itemValue=""/>
                        <f:selectItems value="#{menuSelBean.studyList}"/>
                        <p:ajax update="mdDlg-selPanel"/>
                    </p:selectOneMenu>
                </h:panelGroup>
            </h:panelGrid>
            <p:separator styleClass="configsep"/>
            
            <h:panelGrid id="mdDlg-selPanel" width="100%" columns="2" cellspacing="2" 
                         cellpadding="2">
                <p:commandButton value="Cancel" oncomplete="PF('mdDlg').hide()" 
                                 action="#{menuSelBean.backToMainMenu}" 
                                 style="width: 100%"/>
                <p:commandButton value="Proceed" 
                                 rendered="#{menuSelBean.studySelectedStatus}" 
                                 action="#{menuSelBean.proceedToMetaDataMgnt}" 
                                 style="width: 100%"/>
            </h:panelGrid>
        </h:form>
    </p:dialog>
        
    <p:dialog modal="true" header="Select Study to work on" 
              widgetVar="dlg" resizable="false">
        <h:form id="dlgForm">
            <h:panelGrid columns="1">
                <h:panelGroup>
                    <p:selectOneMenu id="dlg-studyID" value="#{menuSelBean.study_id}">
                        <f:selectItem itemLabel="Select Study" itemValue=""/>
                        <f:selectItems value="#{menuSelBean.studyList}"/>
                        <p:ajax update="dlg-selPanel"/>
                    </p:selectOneMenu>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputText value="New data to upload? " style="font-weight:bold"/>
                    <p:selectBooleanButton id="newdatastatus" 
                                           value="#{menuSelBean.haveNewData}" 
                                           onLabel="Yes" offLabel="No"/>                    
                </h:panelGroup>
            </h:panelGrid>
            <p:separator styleClass="configsep"/>
            
            <h:panelGrid id="dlg-selPanel" width="100%" columns="2" cellspacing="2" 
                         cellpadding="2">
                <p:commandButton value="Cancel" oncomplete="PF('dlg').hide()" 
                                 action="#{menuSelBean.backToMainMenu}" 
                                 style="width: 100%"/>
                <p:commandButton value="Proceed" 
                                 rendered="#{menuSelBean.studySelectedStatus}" 
                                 action="#{menuSelBean.proceedToConfig}" 
                                 style="width: 100%"/>
            </h:panelGrid>
        </h:form>
    </p:dialog>
    </ui:define>
</ui:composition>
